{"ast":null,"code":"var _jsxFileName = \"/Users/calving/Desktop/rails-react-auth-lecture-master/session-auth-client/src/components/App.js\";\nimport React from 'react';\nimport { Switch, Route, withRouter, Redirect } from 'react-router-dom';\nimport SignUp from './SignUp';\nimport Login from './Login';\nimport NavBar from './NavBar';\nimport Profile from './Profile';\n\nclass App extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      currentUser: null\n    };\n\n    this.updateUser = newUser => {\n      this.setState({\n        currentUser: newUser\n      });\n    };\n\n    this.handleLogin = currentUser => {\n      // set current user, then redirect to home page\n      this.setState({\n        currentUser\n      }, () => {\n        this.props.history.push('/home');\n      });\n    };\n\n    this.handleLogout = () => {\n      fetch(\"http://localhost:3000/logout\", {\n        credentials: \"include\"\n      }).then(r => r.json()).then(() => {\n        this.setState({\n          currentUser: null\n        }, () => {\n          this.props.history.push('/');\n        });\n      });\n    };\n  }\n\n  // log user in when component mounts\n  componentDidMount() {\n    // TODO: check if user is logged in\n    // and set current user in state\n    fetch(\"http://localhost:3000/autologin\", {\n      credentials: \"include\"\n    }).then(r => {\n      if (r.ok) {\n        return r.json();\n      } else {\n        throw Error(\"Not logged in!\");\n      }\n    }).then(user => {\n      this.handleLogin(user);\n    }).catch(err => console.error(err));\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(NavBar, {\n      currentUser: this.state.currentUser,\n      handleLogout: this.handleLogout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"main\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      path: \"/signup\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(SignUp, {\n      handleLogin: this.handleLogin,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(Route, {\n      path: \"/login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Login, {\n      handleLogin: this.handleLogin,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(Route, {\n      path: \"/profile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 13\n      }\n    }, this.state.currentUser ? /*#__PURE__*/React.createElement(Profile, {\n      currentUser: this.state.currentUser,\n      updateUser: this.updateUser,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 41\n      }\n    }) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 121\n      }\n    })), /*#__PURE__*/React.createElement(Route, {\n      path: \"/home\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 13\n      }\n    }, this.state.currentUser ? /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 41\n      }\n    }, \"Welcome, \", this.state.currentUser.username) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 95\n      }\n    })), /*#__PURE__*/React.createElement(Route, {\n      path: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 15\n      }\n    }, \"Please Login or Sign Up\")))));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["/Users/calving/Desktop/rails-react-auth-lecture-master/session-auth-client/src/components/App.js"],"names":["React","Switch","Route","withRouter","Redirect","SignUp","Login","NavBar","Profile","App","Component","state","currentUser","updateUser","newUser","setState","handleLogin","props","history","push","handleLogout","fetch","credentials","then","r","json","componentDidMount","ok","Error","user","catch","err","console","error","render","username"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Switch, Route, withRouter, Redirect } from 'react-router-dom'\nimport SignUp from './SignUp'\nimport Login from './Login'\nimport NavBar from './NavBar'\nimport Profile from './Profile'\n\nclass App extends React.Component {\n  state = {\n    currentUser: null\n  }\n\n  // log user in when component mounts\n  componentDidMount() {\n    // TODO: check if user is logged in\n    // and set current user in state\n    fetch(\"http://localhost:3000/autologin\", {\n      credentials: \"include\"\n    })\n      .then(r => {\n        if (r.ok) {\n          return r.json()\n        } else {\n          throw Error(\"Not logged in!\")\n        }\n      })\n      .then(user => {\n        this.handleLogin(user)\n      })\n      .catch((err) => console.error(err))\n  }\n\n  updateUser = newUser => {\n    this.setState({ currentUser: newUser })\n  }\n\n  handleLogin = currentUser => {\n    // set current user, then redirect to home page\n    this.setState({ currentUser }, () => {\n      this.props.history.push('/home')\n    })\n  }\n\n  handleLogout = () => {\n    fetch(\"http://localhost:3000/logout\", {\n      credentials: \"include\"\n    })\n      .then(r => r.json())\n      .then(() => {\n        this.setState({ currentUser: null }, () => {\n          this.props.history.push('/')\n        })\n      })\n  }\n\n  render() {\n\n    return (\n      <>\n        <NavBar currentUser={this.state.currentUser} handleLogout={this.handleLogout} />\n        <main>\n          <Switch>\n\n            <Route path=\"/signup\">\n              <SignUp handleLogin={this.handleLogin} />\n            </Route>\n\n            <Route path=\"/login\">\n              <Login handleLogin={this.handleLogin} />\n            </Route>\n\n            <Route path=\"/profile\">\n              {this.state.currentUser ? <Profile currentUser={this.state.currentUser} updateUser={this.updateUser} /> : <Redirect to='/' />}\n            </Route>\n\n            <Route path=\"/home\">\n              {this.state.currentUser ? <h1>Welcome, {this.state.currentUser.username}</h1> : <Redirect to='/' />}\n            </Route>\n\n            <Route path=\"/\">\n              <h1>Please Login or Sign Up</h1>\n            </Route>\n            \n          </Switch>\n        </main>\n      </>\n    );\n  }\n}\n\nexport default withRouter(App);\n"]},"metadata":{},"sourceType":"module"}
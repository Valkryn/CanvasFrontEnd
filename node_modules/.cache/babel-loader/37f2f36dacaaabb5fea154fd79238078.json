{"ast":null,"code":"var _jsxFileName = \"/Users/calving/Desktop/mod5/gallerySevenFront/src/components/App.js\";\nimport React from 'react';\nimport { Switch, Route, withRouter, Redirect } from 'react-router-dom';\nimport SignUp from './SignUp';\nimport Login from './Login';\nimport NavBar from './NavBar';\nimport Profile from './Profile';\nimport PostContainer from './PostContainer'; // import '../index.css';\n// import ImageUpload from \"./ImageUpload\"\n\nimport PostPage from \"./PostPage\";\n\nclass App extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      currentUser: null,\n      collection: []\n    };\n\n    this.updateUser = newUser => {\n      this.setState({\n        currentUser: newUser\n      });\n    };\n\n    this.handleLogin = currentUser => {\n      // set current user, then redirect to home page\n      this.setState({\n        currentUser\n      }, () => {\n        this.props.history.push('/');\n      });\n    };\n\n    this.handleLogout = () => {\n      fetch(\"http://localhost:3000/logout\", {\n        credentials: \"include\"\n      }).then(resp => resp.json()).then(() => {\n        this.setState({\n          currentUser: null\n        }, () => {\n          this.props.history.push('/');\n        });\n      });\n    };\n\n    this.handleViews = obj => {\n      let newViewCount = parseInt(obj.views) + 1;\n      let newObject = obj;\n      newObject.views = newViewCount;\n      let targetPost = this.state.collection.filter(object => object.id !== obj.id);\n      let newCollection = [newObject, ...targetPost];\n      fetch(`http://localhost:3000/posts/${obj.id}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          views: newViewCount\n        })\n      }).then(resp => resp.json()).then(obj => {\n        this.setState(prevState => ({\n          collection: newCollection\n        }));\n      });\n    };\n\n    this.handleAddingNewImageToCollection = obj => {\n      console.log(obj);\n    };\n  }\n\n  componentDidMount() {\n    fetch(\"http://localhost:3000/autologin\", {\n      credentials: \"include\"\n    }).then(resp => {\n      if (resp.ok) {\n        return resp.json();\n      } else {\n        throw Error(\"Not logged in!\");\n      }\n    }).then(user => {\n      this.handleLogin(user);\n    }).catch(err => console.error(err));\n    fetch(\"http://localhost:3000/posts\").then(resp => resp.json()).then(obj => {\n      this.setState(prevState => ({\n        collection: obj\n      }));\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(NavBar, {\n      currentUser: this.state.currentUser,\n      handleLogout: this.handleLogout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"main\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      path: \"/signup\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(SignUp, {\n      handleLogin: this.handleLogin,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(Route, {\n      path: \"/login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Login, {\n      handleLogin: this.handleLogin,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(Route, {\n      path: \"/profile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 13\n      }\n    }, this.state.currentUser ? /*#__PURE__*/React.createElement(Profile, {\n      currentUser: this.state.currentUser,\n      updateUser: this.updateUser,\n      handleAddingNewImageToCollection: this.handleAddingNewImageToCollection,\n      collection: this.state.collection,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 41\n      }\n    }) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 89\n      }\n    })), /*#__PURE__*/React.createElement(Route, {\n      path: \"/home\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 13\n      }\n    }, this.state.currentUser ? /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"welcome\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 41\n      }\n    }, \"Welcome to Gallery Seven \", this.state.currentUser.username) : /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 131\n      }\n    })), /*#__PURE__*/React.createElement(Route, {\n      path: \"/posts/:id\",\n      component: PostPage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"welcome\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }\n    }, \"Gallery Seven\"), /*#__PURE__*/React.createElement(PostContainer, {\n      objects: this.state.collection,\n      handleViews: this.handleViews,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }\n    }))))));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["/Users/calving/Desktop/mod5/gallerySevenFront/src/components/App.js"],"names":["React","Switch","Route","withRouter","Redirect","SignUp","Login","NavBar","Profile","PostContainer","PostPage","App","Component","state","currentUser","collection","updateUser","newUser","setState","handleLogin","props","history","push","handleLogout","fetch","credentials","then","resp","json","handleViews","obj","newViewCount","parseInt","views","newObject","targetPost","filter","object","id","newCollection","method","headers","body","JSON","stringify","prevState","handleAddingNewImageToCollection","console","log","componentDidMount","ok","Error","user","catch","err","error","render","username"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Switch, Route, withRouter, Redirect } from 'react-router-dom'\nimport SignUp from './SignUp'\nimport Login from './Login'\nimport NavBar from './NavBar'\nimport Profile from './Profile'\nimport PostContainer from './PostContainer'\n// import '../index.css';\n// import ImageUpload from \"./ImageUpload\"\nimport PostPage from \"./PostPage\"\n\n\n\n\n\nclass App extends React.Component {\n  state = {\n    currentUser: null,\n    collection:[]\n  }\n\n\n  componentDidMount() {\n    fetch(\"http://localhost:3000/autologin\", {\n      credentials: \"include\"\n    })\n      .then(resp => {\n        if (resp.ok) {\n          return resp.json()\n        } else {\n          throw Error(\"Not logged in!\")\n        }\n      })\n      .then(user => {\n        this.handleLogin(user)\n      })\n      .catch((err) => console.error(err))\n\n      fetch(\"http://localhost:3000/posts\")\n    .then(resp => resp.json())\n    .then((obj) => {\n      this.setState((prevState) => ({\n        collection:obj\n      }))\n    })\n  }\n\n  updateUser = newUser => {\n    this.setState({ currentUser: newUser })\n  }\n\n  handleLogin = currentUser => {\n    // set current user, then redirect to home page\n    this.setState({ currentUser }, () => {\n      this.props.history.push('/')\n    })\n  }\n\n  handleLogout = () => {\n    fetch(\"http://localhost:3000/logout\", {\n      credentials: \"include\"\n    })\n      .then(resp => resp.json())\n      .then(() => {\n        this.setState({ currentUser: null }, () => {\n          this.props.history.push('/')\n        })\n      })\n  }\n\n  handleViews = (obj) =>{\n    let newViewCount = parseInt(obj.views) + 1\n    let newObject = obj\n    newObject.views = newViewCount\n    let targetPost = this.state.collection.filter(object => object.id !==obj.id)\n    let newCollection = [newObject, ...targetPost]\n\n    fetch(`http://localhost:3000/posts/${obj.id}`, {\n      method:\"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        views:newViewCount\n      })\n    })\n    .then(resp => resp.json())\n    .then((obj) => {\n      this.setState((prevState) => ({\n        collection :newCollection\n      }))\n    })\n  }\n\n  handleAddingNewImageToCollection = (obj) => {\n    console.log(obj)\n  }\n\n  render() {\n    return (\n      <>\n        <NavBar currentUser={this.state.currentUser} handleLogout={this.handleLogout} />\n\n        <main>\n\n          <Switch>\n\n            <Route path=\"/signup\">\n              <SignUp handleLogin={this.handleLogin} />\n            </Route>\n\n            <Route path=\"/login\">\n              <Login handleLogin={this.handleLogin} />\n            </Route>\n\n            <Route path=\"/profile\">\n              {this.state.currentUser ? <Profile currentUser={this.state.currentUser}\n                                                 updateUser={this.updateUser} \n                                                 handleAddingNewImageToCollection={this.handleAddingNewImageToCollection}\n                                                 collection={this.state.collection}/> : <Redirect to='/' />}\n            </Route>\n\n            <Route path=\"/home\">\n              {this.state.currentUser ? <h1 className=\"welcome\">Welcome to Gallery Seven {this.state.currentUser.username}</h1> : <Redirect to='/' />}\n            </Route>\n\n            <Route path=\"/posts/:id\" component={PostPage} />\n\n\n            <Route path=\"/\">\n              <div className=\"welcome\">\n                <h1>Gallery Seven</h1>\n                <PostContainer objects={this.state.collection} handleViews={this.handleViews}/>\n              </div >\n            </Route>\n\n          </Switch>\n\n\n        </main>\n      </>\n    );\n  }\n}\n\nexport default withRouter(App);\n"]},"metadata":{},"sourceType":"module"}